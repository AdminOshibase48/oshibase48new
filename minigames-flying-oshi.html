<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Flying Oshi | Oshibase48</title>
  <link rel="icon" href="img/logo.png" />
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      background: #242D4C;
      font-family: 'Poppins', sans-serif;
      color: #F1EAD8;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    header.navbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem;
      background-color: #1e2540;
      width: 100%;
      box-sizing: border-box;
    }

    .logo {
      display: flex;
      align-items: center;
      font-weight: 600;
      color: #F1EAD8;
    }

    .logo img {
      height: 32px;
      margin-right: 10px;
    }

    nav a {
      margin: 0 0.7rem;
      text-decoration: none;
      color: #F1EAD8;
      font-weight: 600;
    }

    canvas {
      background: url('img/bg-pixel.png') repeat-x;
      background-size: cover;
      border: 2px solid #F1EAD8;
      margin-top: 20px;
    }

    #playButton {
      font-family: 'Press Start 2P', cursive;
      font-size: 14px;
      background: #f5b860;
      border: none;
      padding: 12px 20px;
      color: #242D4C;
      cursor: pointer;
      margin-top: 1rem;
    }

    #jumpButton {
      position: fixed;
      bottom: 90px;
      right: 20px;
      padding: 14px 16px;
      background: #f5b860;
      color: #242D4C;
      font-weight: bold;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      z-index: 10;
    }

    #volumeToggle {
      position: fixed;
      bottom: 20px;
      left: 20px;
      padding: 8px 10px;
      background: #f5b860;
      color: #242D4C;
      font-weight: bold;
      border-radius: 6px;
      border: none;
      z-index: 10;
    }

    footer {
      text-align: center;
      margin: 2rem 0 1rem;
      font-size: 0.9rem;
      color: #F1EAD8;
    }

    @media (max-width: 768px) {
      canvas {
        width: 90vw !important;
        height: 50vh !important;
      }
    }
  </style>
</head>
<body>

  <header class="navbar">
    <div class="logo">
      <img src="img/logo.png" alt="Logo">
      Oshibase48
    </div>
    <nav>
      <a href="index.html">Home</a>
      <a href="berita.html">Berita</a>
      <a href="galeri.html">Galeri</a>
      <a href="jadwal.html">Jadwal</a>
      <a href="shop.html">Shop</a>
      <a href="minigames.html">Minigames</a>
    </nav>
  </header>

  <button id="playButton">PLAY</button>
  <canvas id="gameCanvas" width="480" height="360"></canvas>
  <button id="jumpButton">üïπÔ∏è LONCAT</button>
  <button id="volumeToggle">üîä</button>

  <footer>
    <div>Oshibase48 | Komunitas fans idol penuh semangat dan solidaritas</div>
  </footer>

  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const playBtn = document.getElementById('playButton');
    const jumpBtn = document.getElementById('jumpButton');
    const volumeBtn = document.getElementById('volumeToggle');

    let oshiY = canvas.height / 2;
    let velocity = 0;
    let gravity = 0.3;
    let lift = -6;
    let obstacles = [];
    let score = 0;
    let lives = 3;
    let isGameRunning = false;
    let isMuted = false;

    const jumpSound = new Audio('sound/jump.mp3');
    const bgMusic = new Audio('sound/bg.mp3');
    bgMusic.loop = true;

    function drawOshi() {
      const oshiImg = new Image();
      oshiImg.src = 'img/oshipixel.png';
      ctx.drawImage(oshiImg, 40, oshiY, 40, 40);
    }

    function drawObstacle(obs) {
      ctx.fillStyle = '#f5b860';
      ctx.fillRect(obs.x, 0, obs.width, obs.top);
      ctx.fillRect(obs.x, canvas.height - obs.bottom, obs.width, obs.bottom);
    }

    function updateGame() {
      if (!isGameRunning) return;

      ctx.clearRect(0, 0, canvas.width, canvas.height);
      velocity += gravity;
      oshiY += velocity;

      if (oshiY + 40 > canvas.height) {
        lives--;
        oshiY = canvas.height / 2;
        velocity = 0;
        if (lives <= 0) {
          isGameRunning = false;
          alert('Game Over! Skor: ' + score);
          return;
        }
      }

      if (oshiY < 0) oshiY = 0;

      drawOshi();

      if (Math.random() < 0.02) {
        obstacles.push({
          x: canvas.width,
          width: 40,
          top: Math.random() * 100 + 20,
          bottom: Math.random() * 100 + 20
        });
      }

      for (let i = obstacles.length - 1; i >= 0; i--) {
        const obs = obstacles[i];
        obs.x -= 2;

        drawObstacle(obs);

        // collision
        if (
          40 + 40 > obs.x &&
          40 < obs.x + obs.width &&
          (oshiY < obs.top || oshiY + 40 > canvas.height - obs.bottom)
        ) {
          lives--;
          obstacles.splice(i, 1);
          if (lives <= 0) {
            isGameRunning = false;
            alert('Game Over! Skor: ' + score);
            return;
          }
        }

        if (obs.x + obs.width < 40) {
          score++;
          obstacles.splice(i, 1);
        }
      }

      // Score & lives
      ctx.fillStyle = '#F1EAD8';
      ctx.font = '16px Poppins';
      ctx.fillText('Skor: ' + score, 10, 20);
      ctx.fillText('‚ù§Ô∏è: ' + lives, 10, 40);

      requestAnimationFrame(updateGame);
    }

    function startGame() {
      score = 0;
      lives = 3;
      oshiY = canvas.height / 2;
      velocity = 0;
      obstacles = [];
      isGameRunning = true;
      bgMusic.play();
      updateGame();
    }

    function jump() {
      velocity = lift;
      if (!isMuted) jumpSound.play();
    }

    playBtn.addEventListener('click', startGame);
    jumpBtn.addEventListener('click', jump);
    document.addEventListener('keydown', e => {
      if (e.code === 'Space') jump();
    });

    volumeBtn.addEventListener('click', () => {
      isMuted = !isMuted;
      bgMusic.muted = isMuted;
      jumpSound.muted = isMuted;
      volumeBtn.innerText = isMuted ? 'üîá' : 'üîä';
    });
  </script>
</body>
</html>
